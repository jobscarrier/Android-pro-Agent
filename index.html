<div class="container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Input Panel -->
        <div class="bg-white rounded-lg card-shadow p-6">
            <h2 class="text-2xl font-semibold mb-6 text-gray-800">
                <i class="fas fa-cogs mr-2 text-blue-600"></i>Configuration
            </h2>

            <!-- Base User Agent -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-code mr-1"></i>Base User Agent
                </label>
                <textarea id="baseUserAgent" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                    placeholder="Enter your base Android user agent string here..."></textarea>
            </div>

            <!-- Android Version -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fab fa-android mr-1 text-green-600"></i>Android Version
                </label>
                <input type="text" id="androidVersion" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                    placeholder="e.g., 11, 12, 13, 14, 15">
            </div>

            <!-- Build Version -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-hammer mr-1 text-orange-600"></i>Build Version
                </label>
                <input type="text" id="buildVersion" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                    placeholder="e.g., TP1A.220624.014, RKQ1.210614.002">
            </div>

            <!-- FBAV Versions Pool -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fab fa-facebook mr-1 text-blue-600"></i>FBAV Versions Pool
                </label>
                <div class="flex mb-2">
                    <input type="text" id="fbavInput" class="flex-1 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                        placeholder="e.g., 523.0.0.23.106">
                    <button onclick="addFbavVersion()" class="px-4 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 transition-colors">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div id="fbavPool" class="flex flex-wrap gap-2"></div>
            </div>

            <!-- Chrome Versions Pool -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fab fa-chrome mr-1 text-red-600"></i>Chrome Versions Pool
                </label>
                <div class="flex mb-2">
                    <input type="text" id="chromeInput" class="flex-1 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                        placeholder="e.g., 145.0.5938.153">
                    <button onclick="addChromeVersion()" class="px-4 py-2 bg-red-600 text-white rounded-r-md hover:bg-red-700 transition-colors">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div id="chromePool" class="flex flex-wrap gap-2"></div>
            </div>

            <!-- Quantity -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-hashtag mr-1 text-purple-600"></i>Quantity to Generate
                </label>
                <input type="number" id="quantity" min="1" max="10000" value="10" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <!-- Generate Button -->
            <button onclick="generateUserAgents()" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-md hover:from-blue-700 hover:to-purple-700 transition-all transform hover:scale-105 font-semibold">
                <i class="fas fa-magic mr-2"></i>Generate User Agents
            </button>
        </div>

        <!-- Output Panel -->
        <div class="bg-white rounded-lg card-shadow p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-800">
                    <i class="fas fa-list mr-2 text-green-600"></i>Generated User Agents
                </h2>
                <div class="flex gap-2">
                    <button onclick="copyAllUserAgents()" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm">
                        <i class="fas fa-copy mr-1"></i>Copy All
                    </button>
                    <button onclick="downloadUserAgents()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm">
                        <i class="fas fa-download mr-1"></i>Download
                    </button>
                </div>
            </div>

            <div id="output" class="bg-gray-50 border rounded-md p-4 min-h-96 max-h-96 overflow-y-auto">
                <p class="text-gray-500 text-center mt-20">
                    <i class="fas fa-arrow-left mr-2"></i>Configure settings and click "Generate User Agents" to see results
                </p>
            </div>

            <div id="stats" class="mt-4 text-sm text-gray-600 hidden">
                <i class="fas fa-info-circle mr-1"></i>
                <span id="statsText"></span>
            </div>
        </div>
    </div>
</div>

<script>
    let fbavVersions = [];
    let chromeVersions = [];
    let generatedUserAgents = [];

    // Load saved data on page load
    window.onload = function() {
        loadSavedData();
    };

    function loadSavedData() {
        const savedData = JSON.parse(localStorage.getItem('userAgentGeneratorData') || '{}');
        
        if (savedData.baseUserAgent) document.getElementById('baseUserAgent').value = savedData.baseUserAgent;
        if (savedData.androidVersion) document.getElementById('androidVersion').value = savedData.androidVersion;
        if (savedData.buildVersion) document.getElementById('buildVersion').value = savedData.buildVersion;
        if (savedData.quantity) document.getElementById('quantity').value = savedData.quantity;
        
        fbavVersions = savedData.fbavVersions || [];
        chromeVersions = savedData.chromeVersions || [];
        
        renderPools();
    }

    function saveData() {
        const data = {
            baseUserAgent: document.getElementById('baseUserAgent').value,
            androidVersion: document.getElementById('androidVersion').value,
            buildVersion: document.getElementById('buildVersion').value,
            quantity: document.getElementById('quantity').value,
            fbavVersions: fbavVersions,
            chromeVersions: chromeVersions
        };
        localStorage.setItem('userAgentGeneratorData', JSON.stringify(data));
    }

    function addFbavVersion() {
        const input = document.getElementById('fbavInput');
        const version = input.value.trim();
        if (version && !fbavVersions.includes(version)) {
            fbavVersions.push(version);
            input.value = '';
            renderPools();
            saveData();
        }
    }

    function addChromeVersion() {
        const input = document.getElementById('chromeInput');
        const version = input.value.trim();
        if (version && !chromeVersions.includes(version)) {
            chromeVersions.push(version);
            input.value = '';
            renderPools();
            saveData();
        }
    }

    function removeFbavVersion(index) {
        fbavVersions.splice(index, 1);
        renderPools();
        saveData();
    }

    function removeChromeVersion(index) {
        chromeVersions.splice(index, 1);
        renderPools();
        saveData();
    }

    function renderPools() {
        const fbavPool = document.getElementById('fbavPool');
        const chromePool = document.getElementById('chromePool');

        fbavPool.innerHTML = fbavVersions.map((version, index) => 
            `<span class="pool-item bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm">
                ${version}
                <button onclick="removeFbavVersion(${index})" class="ml-1 text-blue-600 hover:text-blue-800">×</button>
            </span>`
        ).join('');

        chromePool.innerHTML = chromeVersions.map((version, index) => 
            `<span class="pool-item bg-red-100 text-red-800 px-2 py-1 rounded-full text-sm">
                ${version}
                <button onclick="removeChromeVersion(${index})" class="ml-1 text-red-600 hover:text-red-800">×</button>
            </span>`
        ).join('');
    }

    function generateUserAgents() {
        const baseUserAgent = document.getElementById('baseUserAgent').value.trim();
        const androidVersion = document.getElementById('androidVersion').value.trim();
        const buildVersion = document.getElementById('buildVersion').value.trim();
        const quantity = parseInt(document.getElementById('quantity').value);

        if (!baseUserAgent) {
            alert('Please enter a base user agent string.');
            return;
        }

        if (!androidVersion && !buildVersion && fbavVersions.length === 0 && chromeVersions.length === 0) {
            alert('Please configure at least one customization parameter (Android version, Build version, FBAV versions, or Chrome versions).');
            return;
        }

        generatedUserAgents = [];

        for (let i = 0; i < quantity; i++) {
            let userAgent = baseUserAgent;

            // Replace Android version
            if (androidVersion) {
                userAgent = userAgent.replace(/Android\s+[\d.]+/g, `Android ${androidVersion}`);
            }

            // Replace Build version
            if (buildVersion) {
                userAgent = userAgent.replace(/;\s*wv\)\s*AppleWebKit\/[\d.]+\s*\(KHTML,\s*like\s*Gecko\)\s*Version\/[\d.]+\s*Chrome\/[\d.]+\s*Mobile\s*Safari\/[\d.]+\s*\[FB_IAB\/FB4A;FBAV\/[\d.]+;]/g, 
                    match => match.replace(/\[FB_IAB\/FB4A;FBAV\/[\d.]+;/, `[FB_IAB/FB4A;FBAV/${getRandomFromArray(fbavVersions) || 'ORIGINAL'};`));
                
                // Replace build in various patterns
                userAgent = userAgent.replace(/;\s*[A-Z0-9]{2,4}[\d.A-Z]+;\s*wv\)/g, `; ${buildVersion}; wv)`);
                userAgent = userAgent.replace(/Build\/[A-Z0-9.]+/g, `Build/${buildVersion}`);
            }

            // Replace FBAV version
            if (fbavVersions.length > 0) {
                const randomFbav = getRandomFromArray(fbavVersions);
                userAgent = userAgent.replace(/FBAV\/[\d.]+/g, `FBAV/${randomFbav}`);
            }

            // Replace Chrome version
            if (chromeVersions.length > 0) {
                const randomChrome = getRandomFromArray(chromeVersions);
                userAgent = userAgent.replace(/Chrome\/[\d.]+/g, `Chrome/${randomChrome}`);
            }

            generatedUserAgents.push(userAgent);
        }

        displayResults();
        saveData();
    }

    function getRandomFromArray(arr) {
        return arr.length > 0 ? arr[Math.floor(Math.random() * arr.length)] : null;
    }

    function displayResults() {
        const output = document.getElementById('output');
        const stats = document.getElementById('stats');
        const statsText = document.getElementById('statsText');

        output.innerHTML = generatedUserAgents.map((ua, index) => 
            `<div class="mb-2 p-2 bg-white border rounded text-sm font-mono break-all">
                <span class="text-gray-500">${index + 1}.</span> ${ua}
            </div>`
        ).join('');

        statsText.textContent = `Generated ${generatedUserAgents.length} unique user agents`;
        stats.classList.remove('hidden');
    }

    function copyAllUserAgents() {
        if (generatedUserAgents.length === 0) {
            alert('No user agents to copy. Please generate some first.');
            return;
        }

        const text = generatedUserAgents.join('\n');
        navigator.clipboard.writeText(text).then(() => {
            alert('All user agents copied to clipboard!');
        }).catch(() => {
            alert('Failed to copy to clipboard. Please try again.');
        });
    }

    function downloadUserAgents() {
        if (generatedUserAgents.length === 0) {
            alert('No user agents to download. Please generate some first.');
            return;
        }

        const text = generatedUserAgents.join('\n');
        const blob = new Blob([text], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `android_user_agents_${new Date().toISOString().slice(0, 10)}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // Auto-save on input changes
    document.addEventListener('input', saveData);

    // Enter key handlers
    document.getElementById('fbavInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') addFbavVersion();
    });

    document.getElementById('chromeInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') addChromeVersion();
    });
</script>
